<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyAI-Slayer Monitoring Dashboard</title>
    <link rel="stylesheet" href="/static/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.45.0/dist/apexcharts.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <div class="container">
        <!-- Header -->
        <header class="header animate-fade-in">
            <div class="header-left">
                <h1><i data-lucide="target" style="width: 28px; height: 28px; vertical-align: middle; margin-right: 8px;"></i>PyAI-Slayer Monitoring Dashboard</h1>
                <p>Real-time AI Testing Metrics & Comprehensive Reporting</p>
            </div>
            <div class="header-right">
                <div class="connection-status">
                    <span id="statusDot" class="status-dot disconnected"></span>
                    <span id="statusText">Connecting...</span>
                </div>
                <div id="themeToggle" class="theme-toggle" data-theme="dark">
                    <div class="theme-toggle-slider">ğŸŒ™</div>
                </div>
            </div>
        </header>

        <!-- Tabs Navigation -->
        <div class="tabs">
            <button class="tab active" data-tab="overview" onclick="switchTab('overview')">
                ğŸ“Š Overview
            </button>
            <button class="tab" data-tab="tests" onclick="switchTab('tests')">
                ğŸ§ª Test Explorer
            </button>
            <button class="tab" data-tab="failed" onclick="switchTab('failed')">
                âŒ Failed Tests
            </button>
            <button class="tab" data-tab="trends" onclick="switchTab('trends')">
                ğŸ“ˆ Trends
            </button>
        </div>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <!-- Metrics Grid -->
            <div class="metrics-grid">
                <div class="metric-card animate-fade-in" style="animation-delay: 0.1s;">
                    <div class="metric-header">
                        <div class="metric-icon" style="background: var(--primary-light); color: var(--primary);">
                            ğŸ“
                        </div>
                    </div>
                    <div class="metric-label">Total Tests</div>
                    <div class="metric-value" id="totalTests">-</div>
                    <div class="metric-change neutral" id="testsChange">
                        <span>Last 24h</span>
                    </div>
                </div>

                <div class="metric-card animate-fade-in" style="animation-delay: 0.2s;">
                    <div class="metric-header">
                        <div class="metric-icon" style="background: var(--success-light); color: var(--success);">
                            âœ“
                        </div>
                    </div>
                    <div class="metric-label">Pass Rate</div>
                    <div class="metric-value" id="passRate" style="color: var(--success);">-</div>
                    <div class="metric-change positive" id="passRateChange">
                        <span>â†‘ Excellent</span>
                    </div>
                </div>

                <div class="metric-card animate-fade-in" style="animation-delay: 0.3s;">
                    <div class="metric-header">
                        <div class="metric-icon" style="background: var(--danger-light); color: var(--danger);">
                            âœ—
                        </div>
                    </div>
                    <div class="metric-label">Failed Tests</div>
                    <div class="metric-value" id="failedTests" style="color: var(--danger);">-</div>
                    <div class="metric-change negative" id="failedChange">
                        <span>Needs attention</span>
                    </div>
                </div>

                <div class="metric-card animate-fade-in" style="animation-delay: 0.4s;">
                    <div class="metric-header">
                        <div class="metric-icon" style="background: var(--info); color: white;">
                            âš¡
                        </div>
                    </div>
                    <div class="metric-label">Avg Duration</div>
                    <div class="metric-value" id="avgDuration">-</div>
                    <div class="metric-change neutral" id="durationChange">
                        <span>Per test</span>
                    </div>
                </div>
            </div>

            <!-- Charts -->
            <div class="chart-container animate-fade-in" style="animation-delay: 0.5s;">
                <div class="chart-title">ğŸ“Š Test Results Distribution</div>
                <div id="resultsChart"></div>
            </div>

            <div class="chart-container animate-fade-in" style="animation-delay: 0.6s;">
                <div class="chart-title">ğŸ¯ Validation Metrics Performance</div>
                <div id="validationChart"></div>
            </div>
        </div>

        <!-- Test Explorer Tab -->
        <div id="tests" class="tab-content">
            <div class="filter-bar">
                <div class="filter-group">
                    <label class="filter-label">Status</label>
                    <select id="statusFilter" onchange="loadTests()">
                        <option value="">All Status</option>
                        <option value="passed">âœ“ Passed</option>
                        <option value="failed">âœ— Failed</option>
                        <option value="skipped">âŠ˜ Skipped</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label class="filter-label">Language</label>
                    <select id="languageFilter" onchange="loadTests()">
                        <option value="">All Languages</option>
                        <option value="en">ğŸ‡¬ğŸ‡§ English</option>
                        <option value="ar">ğŸ‡¸ğŸ‡¦ Arabic</option>
                        <option value="multilingual">ğŸŒ Multilingual</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label class="filter-label">Time Range</label>
                    <select id="hoursFilter" onchange="loadTests()">
                        <option value="24">Last 24 Hours</option>
                        <option value="168">Last 7 Days</option>
                        <option value="720">Last 30 Days</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label class="filter-label" style="opacity: 0;">Action</label>
                    <button onclick="loadTests()">ğŸ”„ Refresh</button>
                </div>
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Test Name</th>
                            <th>Status</th>
                            <th>Language</th>
                            <th>Type</th>
                            <th>Duration</th>
                            <th>Timestamp</th>
                        </tr>
                    </thead>
                    <tbody id="testsTableBody">
                        <tr>
                            <td colspan="6" class="loading">
                                <div class="spinner"></div>
                                Loading tests...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Failed Tests Tab -->
        <div id="failed" class="tab-content">
            <div id="failedTestsList">
                <div class="filter-bar">
                    <div class="filter-group">
                        <label class="filter-label">Language</label>
                        <select id="failedLanguageFilter" onchange="loadFailedTests()">
                            <option value="">All Languages</option>
                            <option value="en">ğŸ‡¬ğŸ‡§ English</option>
                            <option value="ar">ğŸ‡¸ğŸ‡¦ Arabic</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label" style="opacity: 0;">Action</label>
                        <button onclick="loadFailedTests()">ğŸ”„ Refresh</button>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">ğŸ“‰ Failure Patterns Analysis</div>
                    <canvas id="failurePatternsChart"></canvas>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Test Name</th>
                                <th>Language</th>
                                <th>Type</th>
                                <th>Duration</th>
                                <th>Timestamp</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="failedTestsTableBody">
                            <tr>
                                <td colspan="6" class="loading">
                                    <div class="spinner"></div>
                                    Loading failed tests...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="failedTestDetail" style="display: none;"></div>
        </div>

        <!-- Trends Tab -->
        <div id="trends" class="tab-content">
            <div class="chart-container">
                <div class="chart-title">ğŸ“ˆ Test Success Rate Over Time</div>
                <canvas id="successTrendChart"></canvas>
                <p style="text-align: center; color: var(--text-secondary); margin-top: 2rem;">
                    Historical trend analysis coming soon...
                </p>
            </div>

            <div class="chart-container">
                <div class="chart-title">ğŸ“Š Validation Metrics History</div>
                <canvas id="validationTrendChart"></canvas>
                <p style="text-align: center; color: var(--text-secondary); margin-top: 2rem;">
                    Validation metrics trends coming soon...
                </p>
            </div>
        </div>
    </div>

    <!-- Load JavaScript -->
    <script src="/static/charts_advanced.js"></script>
    <script src="/static/dashboard.js"></script>
</body>
</html>
